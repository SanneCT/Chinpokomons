<%-include('./partials/header') %>

<form action="" id="addPokomon">
<p class="d-none"><%= user.username %></p>

        <input type="text" name="name" placeholder="name of chinpokomon">

        <input type="text" name="ability1" placeholder="ability 1">

        <input type="text" name="ability2" placeholder="ability 2">
        
        <input type="text" name="ability3" placeholder="ability 3">
        
        <input type="submit" value="Last opp">
    </form>


<%-include('./partials/footer') %>

<script>
const addpokomonform = document.querySelector('#addPokomon');
const author = document.querySelector('.d-none').innerText;

addpokomonform.addEventListener('submit', async e => {
    e.preventDefault();
    console.log('making pokomon');
    try{
        const response = await fetch(
            '/pokomon',
            {
                method: 'POST',
                body: JSON.stringify(
                    {
                        name: addpokomonform['name'].value,
                        ability1: addpokomonform['ability1'].value,
                        ability2: addpokomonform['ability2'].value,
                        ability3: addpokomonform['ability3'].value,
                        author
                    }),
                headers: {'Content-Type': 'application/json'}
            });
        if(response) {
            result = await response.json();
            console.log(result);
        }
        addpokomonform.reset();
    }catch(err){
        console.log(err);
    }
});
</script>